{# Componente: Carrito flotante en cabecera #}
{% if order %}
    <div class="inline-flex items-center gap-1 px-3 py-2 rounded-lg bg-yellow-100 text-yellow-800 font-semibold transition relative group cursor-pointer select-none"
         onclick="window.location.href='/order/checkout'">
        <i data-feather="shopping-cart"></i>
        <span>Ver carrito</span>
        <div class="absolute right-0 top-full mt-2 w-64 bg-white border border-yellow-200 rounded-lg shadow-lg z-50 hidden group-hover:block group-focus:block">
            <div class="p-3 max-h-64 overflow-y-auto">
                {% if order.items and order.items|length > 0 %}
                    <ul class="divide-y divide-gray-100">
                        {% for item in order.items %}
                            {% set product = item.product is defined ? item.product : null %}
                            <li class="py-2 flex items-center gap-2">
                                {% if product %}
                                    <img src="/{{ product.getImagePath() }}" alt="{{ product.name }}" class="w-8 h-8 rounded object-cover">
                                    <span class="flex-1 text-gray-800 text-sm">{{ product.name }}</span>
                                {% else %}
                                    <span class="flex-1 text-gray-800 text-sm">Producto #{{ item.product_id }}</span>
                                {% endif %}
                                <span class="text-primary font-bold text-xs">x{{ item.quantity }}</span>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="text-gray-500 text-sm">El carrito está vacío.</div>
                {% endif %}
            </div>
        </div>
    </div>
{% endif %}
